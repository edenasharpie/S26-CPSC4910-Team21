# readOnly properties are auto-generated by the system
# writeOnly properties are only accepted in requests,
# and never returned in responses (for sensitive data)

# common properties for all events
Event:
  type: object
  properties:
    id:
      type: string
      format: uuid
      description: Unique identifier for the event.
      readOnly: true
    timestamp:
      type: string
      format: date-time
      description: The time when the event occurred.
      readOnly: true
    userId:
      type: string
      format: uuid
      description: Unique identifier of the user associated with the event.
      readOnly: true

Notification:
  allOf:
    - $ref: '#/Event'
    - type: object
      properties:
        content:
          type: string
          description: The content of the notification.
          readOnly: true

PointTransaction:
  allOf:
    - $ref: '#/Event'
    - type: object
      properties:
        pointsDelta:
          type: integer
          description: The change in points (positive or negative).
          readOnly: true
        reason:
          type: string
          description: The reason for the point transaction.
          readOnly: true

LoginAttempt:
  allOf:
    - $ref: '#/Event'
    - type: object
      properties:
        success:
          type: boolean
          description: Whether the login attempt was successful.
          readOnly: true
        result:
          type: string
          enum: [username_not_found, failed, success, failed_too_many_attempts]
          description: The result of the login attempt.
          readOnly: true
        ipAddress:
          type: string
          format: ipv4
          description: The IP address from which the login attempt was made.
          readOnly: true

PasswordChange:
  allOf:
    - $ref: '#/Event'
    - type: object
      properties:
        success:
          type: boolean
          description: Whether the password change was successful.
          readOnly: true
        changeMethod:
          type: string
          enum: [user_initiated, admin_initiated, password_reset]
          description: The method by which the password was changed.
          readOnly: true
      
AccountStatusChange:
  allOf:
    - $ref: '#/Event'
    - type: object
      properties:
        newStatus:
          type: boolean
          description: "The state the account was changed to."
        targetUserId:
          type: string
          format: uuid
          description: "The ID of the admin user being reactivated."
        adminNotes:
          type: string
          description: "Explanation for the reactivation."

AccountUpdate:
  allOf:
    - $ref: '#/Event'
    - type: object
      properties:
        updatedFields:
          type: array
          items:
            type: string
        isSelfUpdate:
          type: boolean
          description: "True if the Admin updated their own account."
        success:
          type: boolean

ReviewModerationEvent:
  allOf:
    - $ref: '#/Event'
    - type: object
      properties:
        reviewId:
          type: string
          format: uuid
        action:
          type: string
          enum: [hidden, restored, deleted]
        reason:
          type: string

ApplicationStatusUpdate:
  allOf:
    - $ref: '#/Event'
    - type: object
      required:
        - status
      properties:
        status:
          type: string
          enum: [accepted, rejected]
        reviewNotes:
          type: string
          maxLength: 1000